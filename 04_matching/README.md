# Задача матчинга

[]()    [ipynb](https://github.com/Ekaterina-Ann/Portfolio/blob/master/matching/matching.ipynb)

## Описание проекта

В нашем распоряжении датасеты с полностью анонимизированными признаками. Задача заключается в том чтобы соотнести запросы из train и validation датасетов с объектами из base на основании их схожести и найти 5 наиболее близких объекта к каждому запросу.

<b>Описание данных</b>

* `train` - датасет, который содержит объекты, которым необходимо подобрать наиболее подходящие из `base`
* `base` - датасет, который содержит объекты, с которыми необходимо соонтнести объекты
* `validation` - датасет, который содержит объекты для валидации
 
Поскольку датасеты содержат большое количество данных (`base` - около 3 миллионов строк), были подготовлены мини датасеты для подбора лучшей модели.



## Навыки и инструменты

- **python**
- **pandas**
- **numpy**
- **seaborn**
- sklearn.neighbors.**NearestNeighbors**
- **Faiss**



## Вывод

Мы провели исследовательский анализ данных. Пропусков в данных нет, существенной корреляции между признаками не обнаружено.

Поскольку датасеты содержат большое количество данных (`base` - около 3 миллионов строк), мы использовали мини датасеты для подбора лучшей модели.

Поскольку модели делают выводы о близости объектов на основании расчёта растояний до них, мы промасштабировали данные.

Мы исключили некоторые признаки. Мы создали простую модель NearestNeighbors. Мы по очереди исключали каждый признак, и, если метрика без него улучшалась, удаляли этот признак.

На кросс-валидации лучшую метрику accuracy показали модели NearestNeighbors и Faiss с индексом IndexFlatL2. Метрика accuracy составила 76.525%.  Однако NearestNeighbors существенно выигрывает по времени. Общее время выполнения программы 13.67 сек. против 615.15 сек. у IndexFlatL2.
Также мы получили результат модели Faiss с индексом HNSW и IndexIVFFlat accuracy 75.80%, время работы - 50.63 сек.
IndexIVFFlat показал худший результат из всех моделей по accuracy 75.71 %, с временем выполнения 69.91 сек.

Наиболее эффективной мы посчитали модель NearestNeighbors, так как она показала лучшую метрику и лучшее время выполнения. На полном датасете, аccuracy на кросс-валидации составила 71.933 %. А на тестовой выборке - 71.816%. При этом на получение результатов ушло всего около 5 минут.
